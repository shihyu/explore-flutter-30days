<!DOCTYPE HTML>
<html lang="zh-TW" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Day 26: æƒ³è·‘ Flutter æ¸¬è©¦ä½†å»ä¸æƒ³å¯«å—ï¼Œ è©¦çœ‹çœ‹ Maestro UI Testingï¼Œ æ•´åˆ CICD æ²’å•é¡Œï¼ - Flutter éµäººè³½ 60 å¤©åˆè¼¯ï¼šç”±è£¡åˆ°å¤– Ã— é€²æ“Šä¹‹è·¯</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>â†</kbd> or <kbd>â†’</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Flutter éµäººè³½ 60 å¤©åˆè¼¯ï¼šç”±è£¡åˆ°å¤– Ã— é€²æ“Šä¹‹è·¯</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="day-26-æƒ³è·‘-flutter-æ¸¬è©¦ä½†å»ä¸æƒ³å¯«å—-è©¦çœ‹çœ‹-maestro-ui-testing-æ•´åˆ-cicd-æ²’å•é¡Œ"><a class="header" href="#day-26-æƒ³è·‘-flutter-æ¸¬è©¦ä½†å»ä¸æƒ³å¯«å—-è©¦çœ‹çœ‹-maestro-ui-testing-æ•´åˆ-cicd-æ²’å•é¡Œ">Day 26: æƒ³è·‘ Flutter æ¸¬è©¦ä½†å»ä¸æƒ³å¯«å—ï¼Œ è©¦çœ‹çœ‹ Maestro UI Testingï¼Œ æ•´åˆ CICD æ²’å•é¡Œï¼</a></h1>
<ul>
<li>ç™¼å¸ƒæ™‚é–“ï¼š2023-10-11 22:45:03</li>
<li>åŸæ–‡é€£çµï¼š<a href="https://ithelp.ithome.com.tw/articles/10337944">https://ithelp.ithome.com.tw/articles/10337944</a></li>
<li>ç³»åˆ—æ¨™è¨˜ï¼šæ¢ç´¢ Flutter ç”±è£¡åˆ°å¤–ï¼Œä¸‰åå¤©å¸¶ä½ å‰å¾€é€²éšç³»åˆ— ç¬¬ 26 ç¯‡</li>
</ul>
<p><img src="images/20120687DU2MqFXQ10.png" alt="" /></p>
<p><strong>Maestro</strong>Â æ˜¯ä¸€å€‹å®Œæ•´çš„Â <strong>UI</strong>Â è‡ªå‹•åŒ–æ¸¬è©¦æ¡†æ¶èˆ‡è§£æ±ºæ–¹æ¡ˆï¼Œæä¾›è±å¯Œçš„æ–‡ä»¶å’Œ API çµ¦é–‹ç™¼è€…ä½¿ç”¨ï¼Œå…¶ä¸­çš„é€£çºŒæ¨¡å¼å°±å¾ˆç¬¦åˆäººæ€§åŒ–ï¼Œåƒæ˜¯è‡ªå‹• <strong>hot-reload</strong> ä¸€æ¨£ï¼Œèƒ½å¤ æœ‰æ•ˆå¹«åŠ©æ’°å¯«æ¸¬è©¦ï¼Œè€Œä¸”è®“éé–‹ç™¼è€…ä¹Ÿèƒ½åƒèˆ‡ï¼Œé€™é»éå¸¸åŠ åˆ†ï¼Œæ•´é«”ä¾†èªªé«”é©—å¾ˆä¸éŒ¯ã€‚</p>
<p>æœ¬æ–‡é™¤äº†æä¾›åŸºæœ¬çš„æ¸¬è©¦ç¯„ä¾‹ï¼Œä¹Ÿä½¿ç”¨ Script é€²è¡Œè‡ªå‹•åŒ–å¤šÂ <strong>flow</strong>Â é©—è­‰ï¼Œç„¶å¾Œæä¾›çµæœå ±å‘Šï¼Œæœ€å¾Œå°‡ Maestro æ·»åŠ åˆ° Gitlab CICD ä¸­ï¼Œé€éå®ƒå”åŠ©æª¢æŸ¥ Flutter æ‡‰ç”¨ã€‚éç¨‹æœƒä½¿ç”¨è…³æœ¬å•Ÿå‹•æœ¬åœ°æ¨¡æ“¬å™¨ã€åŸ·è¡Œå¤šæµç¨‹é©—è­‰ä¸¦é¡¯ç¤ºå ±å‘Šã€æœ€å¾Œé—œé–‰æ¨¡æ“¬å™¨ï¼Œæ¥è‘—å»ºç½® App å®‰è£æª”ï¼Œç„¶å¾Œå°‡å®ƒéƒ¨ç½²åˆ° App Centerï¼Œè®“é–‹ç™¼è€…èˆ‡ QA äººå“¡å¯ä»¥åœ¨æ‰‹æ©Ÿä¸Šæ“ä½œã€‚</p>
<hr />
<p>å¿«é€Ÿäº†è§£ Maestro çš„å¹¾å€‹ç‰¹é»ï¼š</p>
<ul>
<li>E2E æ¸¬è©¦æ¡†æ¶ï¼Œä½¿ç”¨ yaml å®šç¾©æ¸¬è©¦æµç¨‹</li>
<li>å®¹å¿éåŒæ­¥å’Œå»¶é²ï¼Œé è¨­æœƒè‡ªå‹•ç­‰å¾…æ“ä½œå®Œæˆï¼Œç„¡éœ€æ’°å¯« <code>sleep()</code></li>
<li>é‹è¡Œå¾Œèƒ½å¤ æŒçºŒç›£æ§æ¸¬è©¦æ–‡ä»¶çš„è®Šå‹•ï¼Œä¸¦åœ¨å®ƒå€‘ç™¼ç”Ÿè®ŠåŒ–æ™‚é‡æ–°é‹è¡Œï¼Œä¸éœ€è¦å†æ¬¡ç·¨è­¯</li>
<li>æ”¯æ´ <strong>CI Integration</strong>ï¼Œè‡ªå‹•ä¸Šå‚³åˆ° Maestro å¹³å°é€²è¡Œæ¸¬è©¦ã€‚<a href="https://www.notion.so/Maestro-80cfa567d9e94eccbe44f95413f36f52?pvs=21">link</a></li>
<li>æ”¯æ´ <strong><strong>Pull Request Integration</strong></strong>ï¼Œç™¼ PR å¾Œè‡ªå‹•é€²è¡Œæ¸¬è©¦é©—è­‰ä»¥åŠæ€§èƒ½åˆ†æã€‚<a href="https://cloud.mobile.dev/getting-started/pull-request-integration">link</a></li>
<li>æ”¯æ´ <strong>Crash Analysis</strong>ï¼Œæ¯å€‹æƒ…æ³éƒ½é™„æœ‰è¢å¹•éŒ„å½±ã€Logã€StackTrace</li>
<li>æ”¯æ´ <strong>APP Size</strong> <strong>Analysis</strong>ï¼Œäº†è§£å“ªå€‹éƒ¨åˆ†ä½”æ¯”è¼ƒå¤§ï¼Œå¯ä»¥é€²è¡Œç‰¹å®šå„ªåŒ–</li>
<li>æ”¯æ´ <strong>Memory</strong> <strong>Leaks Analysis</strong>ï¼ŒæŸ¥çœ‹æ´©æ¼ç‹€æ³èˆ‡åŸå› </li>
<li>æ”¯æ´ <strong>Performance</strong> <strong>Analysis</strong>ï¼Œæ¸¬é‡å•Ÿå‹•æ™‚é–“ã€åŸ·è¡Œæ™‚é–“ï¼ŒæŸ¥çœ‹å‡½å¼çš„å‘¼å«ä»¥åŠè€—æ™‚</li>
</ul>
<p>ç›®å‰ä¸»æµ Mobile å¹³å°éƒ½æœ‰æ”¯æ´ï¼š<br />
<img src="images/20120687yP7gCkGQvN.png" alt="" /></p>
<ul>
<li>Android - Views</li>
<li>Android - Jetpack Compose</li>
<li>iOS - UIKit</li>
<li>iOS - SwiftUl</li>
<li>React Native</li>
<li>Flutter</li>
<li>Web Views</li>
<li>NET MAUI iOS</li>
<li>NET MAUI Android</li>
</ul>
<h2 id="å®‰è£-maestro-cli"><a class="header" href="#å®‰è£-maestro-cli">å®‰è£ Maestro CLI</a></h2>
<pre><code class="language-bash">curl -Ls "https://get.maestro.mobile.dev" | bash
</code></pre>
<p><img src="images/20120687qHQ2qFgFBy.png" alt="" /></p>
<h2 id="ios-è¨­å‚™çš„å‰ç½®è¨­å®š"><a class="header" href="#ios-è¨­å‚™çš„å‰ç½®è¨­å®š">iOS è¨­å‚™çš„å‰ç½®è¨­å®š</a></h2>
<ul>
<li>éœ€è¦Â <strong>Facebook IDB(iOS Debug Bridge)</strong>Â å·¥å…·ï¼Œå°±åƒæ˜¯ Android adb å·¥å…·ï¼Œå¯ä»¥è·Ÿè¨­å‚™äº’å‹•ï¼ŒæŸ¥çœ‹è³‡è¨Šã€å®‰è£ã€ç›£æ§é‚„èƒ½æ¨¡æ“¬æ‰‹å‹¢æ“ä½œï¼Œéå¸¸é©åˆè‡ªå‹•åŒ–æ¸¬è©¦</li>
</ul>
<pre><code class="language-bash">brew tap facebook/fb
brew install facebook/fb/idb-companion
</code></pre>
<p><img src="images/20120687sC46G8KvT3.png" alt="" /></p>
<p>ğŸ’¡æŸ¥çœ‹è¨­å‚™æ¸…å–®èˆ‡ID</p>
<pre><code class="language-bash">xcrun simctl list
</code></pre>
<p>![images/20120687mBNmxvKFOA.png]</p>
<p>ğŸ’¡å•Ÿå‹•è¦é‹è¡Œæ¸¬è©¦çš„æ¨¡æ“¬å™¨</p>
<pre><code class="language-bash">idb_companion --boot &lt;id of the iOS device&gt;
</code></pre>
<p>ğŸ’¡é€£çµæ¸¬è©¦æ¨¡æ“¬å™¨ï¼Œé©—è­‰æ˜¯å¦æ­£å¸¸ï¼Œæ²’å•é¡Œå°±å¯ä»¥å°‡æ­¤é‹è¡Œé—œé–‰</p>
<pre><code class="language-bash">idb_companion --udid &lt;id of the iOS device&gt;
</code></pre>
<p>ğŸ’¡é—œé–‰æ¨¡æ“¬å™¨</p>
<pre><code class="language-hljs">idb_companion --shutdown F7CABB3C-DD6F-432D-A86F-5884287D2261
</code></pre>
<blockquote>
<p>æé†’ï¼šæ¸¬è©¦ç›®å‰ç„¡æ³•è·‘åœ¨å¯¦éš›çš„æ‰‹æ©Ÿè¨­å‚™</p>
</blockquote>
<h3 id="é‹è¡Œ-app"><a class="header" href="#é‹è¡Œ-app">é‹è¡Œ APP</a></h3>
<p>åœ¨æ¸¬è©¦åŸ·è¡Œå‰è¦ç¢ºä¿å·²ç¶“æœ‰å®‰è£é APP åˆ°æ¨¡æ“¬å™¨ï¼ŒMaestro æœƒæ ¹æ“š <strong>packageName</strong> æˆ– <strong>bundleId</strong> è‡ªå‹•å°‹æ‰¾åˆ°æŒ‡å®š APP ä¸¦å•Ÿå‹•åŸ·è¡Œæ¸¬è©¦é©—è­‰</p>
<ol>
<li>IDE é‹è¡Œå®‰è£ APP</li>
<li>Android æŒ‡ä»¤å®‰è£</li>
<li>iOS æŒ‡ä»¤å®‰è£</li>
</ol>
<p><strong>Android å®‰è£</strong></p>
<pre><code class="language-bash">adb install sample.apk
</code></pre>
<p><strong>iOS å®‰è£</strong></p>
<pre><code class="language-bash">xcrun simctl install Booted Test.app
</code></pre>
<h3 id="æ’°å¯«æ¸¬è©¦"><a class="header" href="#æ’°å¯«æ¸¬è©¦">æ’°å¯«æ¸¬è©¦</a></h3>
<p>è«‹æŸ¥çœ‹æˆ‘åœ¨ Medium æ’°å¯«çš„æ–‡ç« ï¼Œæœ‰è¬›è§£æ‰€æœ‰çš„æ“ä½œæŒ‡ä»¤ï¼Œé»æ“Šä»¥ä¸‹é€£çµè·³è½‰</p>
<blockquote>
<p><a href="https://medium.com/flutter-formosa/%E4%BD%A0%E7%9F%A5%E9%81%93-maestro-%E5%97%8E-%E5%85%BC%E5%85%B7%E4%BA%BA%E6%80%A7%E7%9A%84%E8%87%AA%E5%8B%95%E5%8C%96%E6%B8%AC%E8%A9%A6%E6%A1%86%E6%9E%B6-flutter-%E5%93%81%E8%B3%AA%E5%B0%B1%E9%9D%A0%E5%AE%83%E4%BA%86-part-2-%E6%8C%87%E4%BB%A4%E8%88%87%E6%93%8D%E4%BD%9C-e6327ed5ac04">æŒ‡ä»¤èˆ‡æ“ä½œ</a></p>
</blockquote>
<h3 id="åŸ·è¡Œ-debug-é€£çºŒæ¸¬è©¦"><a class="header" href="#åŸ·è¡Œ-debug-é€£çºŒæ¸¬è©¦">åŸ·è¡Œ Debug é€£çºŒæ¸¬è©¦</a></h3>
<ul>
<li>é‹è¡Œ <strong>Continuous Mode</strong></li>
<li>é‹è¡Œæ™‚çš†ç‚º Hot reload æ¨¡å¼ï¼Œå³æ™‚ç›£è½ yaml æª”æ¡ˆçš„æ›´æ–°ï¼Œä¸éœ€è¦é‡æ–°ç·¨è­¯å³å¯é‡æ–°é‹è¡Œ</li>
<li>æ¸¬è©¦éç¨‹çš„æª¢æŸ¥æ¢ä»¶æœƒæ ¹æ“šæ“ä½œé€ä¸€ç¢ºèª</li>
<li><strong>Enter</strong> â†’ é»æ“Šå¾Œåˆ·æ–°é‡ä¾†</li>
</ul>
<pre><code class="language-bash">maestro test -c flows/LaunchApp.yaml
</code></pre>
<p><img src="images/20120687a1aMadvP7o.png" alt="" /><br />
<img src="images/YeQ0V2C.gif" alt="Continuous Testing" /></p>
<p>ç•¶ <strong>yaml</strong> æª”çš„æµç¨‹æ’°å¯«æœ‰èª¤æ™‚ï¼Œæœƒå³æ™‚æé†’<br />
<img src="images/20120687Oo398RzLzs.png" alt="" /></p>
<h3 id="åŸ·è¡Œå–®ä¸€-flow-æ¸¬è©¦"><a class="header" href="#åŸ·è¡Œå–®ä¸€-flow-æ¸¬è©¦">åŸ·è¡Œå–®ä¸€ Flow æ¸¬è©¦</a></h3>
<p>æ•´å€‹æµç¨‹æœƒè‡ªå‹•åŸ·è¡Œæ“ä½œï¼Œä¸¦å®Œæˆé©—è­‰ï¼Œæœ€å¾Œé¡¯ç¤ºé€šéçµæœ</p>
<pre><code class="language-bash">maestro test maestro/flows/GoThirdAndScroll.yaml
</code></pre>
<p><img src="images/MbxVoYb.gif" alt="Single Flow" /></p>
<h3 id="åŸ·è¡Œå®Œæ•´å¤š-flow-æ¸¬è©¦"><a class="header" href="#åŸ·è¡Œå®Œæ•´å¤š-flow-æ¸¬è©¦">åŸ·è¡Œå®Œæ•´å¤š Flow æ¸¬è©¦</a></h3>
<ul>
<li>æ¸¬è©¦æ•´å€‹è³‡æ–™å¤¾ï¼Œæ¯å€‹æƒ…å¢ƒéƒ½é©—è­‰ï¼Œä¸¦åœ¨é‹è¡Œå¾Œç”Ÿæˆæ¸¬è©¦å ±å‘Š</li>
<li>ä¸åŒ…å«å­è³‡æ–™å¤¾</li>
<li>åŠ ä¸Š <code>--format junit</code> ç”Ÿæˆ XML çµæœå ±å‘Š</li>
<li>åŠ ä¸Š <code>â€”-output result.xml</code> ä¿®æ”¹åŒ¯å‡ºåç¨±</li>
</ul>
<pre><code class="language-bash">maestro test flows/

maestro test --format junit flows/
</code></pre>
<p><img src="images/20120687ApK7wa898f.png" alt="" /><br />
<img src="images/20120687hBF0ZZPJ84.png" alt="" /><br />
<img src="images/201206875SkmAlZFzH.png" alt="" /></p>
<h3 id="ç¼ºé»"><a class="header" href="#ç¼ºé»">ç¼ºé»</a></h3>
<ol>
<li>å¤š Flow é‹è¡Œ</li>
</ol>
<p>ç•¶éœ€è¦é©—è­‰å¤šå€‹ flow æ¸¬è©¦æ™‚æœƒç„¡æ³•æ­£å¸¸å®Œæˆï¼Œå¾ç¬¬äºŒå€‹ flow é–‹å§‹ä¸æœƒè‡ªå‹•æ“ä½œï¼Œä¾‹å¦‚ï¼šé»æ“ŠæŒ‰éˆ•ã€æ»¾å‹•ç­‰äº’å‹•è¡Œç‚ºï¼Œå¿…é ˆæ‰‹å‹•æ“ä½œç•«é¢è®“ <strong>Maestro</strong> æª¢æŸ¥ï¼Œæ˜¯å€‹å¾ˆä¸æ–¹ä¾¿çš„éç¨‹ã€‚</p>
<p>é€™æ™‚å€™å°±è‡ªè¡Œå„ªåŒ–å›‰ï¼Œé€éæ’°å¯« Shell Script ä¾†è§£æ±ºå•é¡Œï¼Œé€ä¸€é€²è¡Œå€‹åˆ¥çš„ flow é©—è­‰ï¼Œå¯ä»¥æŸ¥çœ‹å°ˆæ¡ˆçš„ <code>/scripts/run_test.sh</code> æª”æ¡ˆã€‚</p>
<p>ä¸»è¦çš„æƒ³æ³•å°±æ˜¯æŠŠæ¸¬è©¦ç›®éŒ„è£¡çš„æ¯å€‹ flow æª”æ¡ˆéƒ½é€²è¡Œé€ä¸€é©—è­‰ï¼Œä¸¦è¨˜éŒ„æˆåŠŸèˆ‡å¤±æ•—çš„æ•¸é‡ï¼Œæœ€å¾Œé¡¯ç¤ºæˆ‘éœ€è¦çš„çµæœå ±å‘Šï¼Œä¸¦é™„å¸¶æ¸¬è©¦é€šéç‡ã€‚å¦‚æœéœ€è¦çš„è©±ï¼Œå¾ŒçºŒå°±èƒ½å¤ æ¥è‘—æ•´åˆ CIï¼Œæ¸¬è©¦æ²’å•é¡Œæ‰èƒ½é€²è¡Œå¾ŒçºŒçš„ APP å»ºç½®ã€‚<br />
<img src="images/20120687d5wcUAfoil.png" alt="" /><br />
<img src="images/20120687Qbpg0kMbBW.png" alt="" /></p>
<p>ä»¥ä¸‹å±•ç¤ºé€é script é©—è­‰å¤šå€‹ flow æ¸¬è©¦ï¼Œæœ€å¾Œæä¾›çµæœ<br />
<img src="images/20120687JtophFNx0x.png" alt="" /><br />
<img src="images/20120687fWphFuLtDs.png" alt="" /><br />
<img src="images/UgW0KrM.gif" alt="Optimize" /></p>
<ol start="2">
<li>
<p>ä¸æ”¯æ´ Flutter Key åµæ¸¬ã€‚è€Œå¦‚æœåŒæ™‚å­˜åœ¨ <strong>semanticLabel</strong> å’Œ <strong>Text Label</strong>ï¼Œå‰‡æœƒä»¥ semantic å„ªå…ˆ</p>
</li>
<li>
<p>ç„¡æ³•åœ¨ Flutter Desktop ä»¥åŠ Flutter Web ä¸Šé‹è¡Œ</p>
</li>
</ol>
<h3 id="maestro-studio"><a class="header" href="#maestro-studio">Maestro Studio</a></h3>
<ul>
<li>é–‹ç™¼è¼”åŠ©å·¥å…·ï¼Œå°±åƒæ˜¯ Flutter DevTools</li>
<li>å¯æŠ“å–æ‰€æœ‰çš„ UI å…ƒç´ ï¼Œä¹Ÿå¯ä»¥æœå°‹é—œéµå­—</li>
<li>ç”Ÿæˆæ¯å€‹ UI å…ƒç´ çš„åŸºæœ¬æ¸¬è©¦æŒ‡ä»¤ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥ç›´æ¥è¤‡è£½ä½¿ç”¨</li>
</ul>
<p><img src="images/20120687JuNF6DaTA7.png" alt="" /><br />
<img src="images/20120687UzVtGwqZi7.png" alt="" /><br />
<img src="images/NQ4ZzZ2.gif" alt="Maestro Studio" /></p>
<h3 id="éŒ„è£½å½±ç‰‡"><a class="header" href="#éŒ„è£½å½±ç‰‡">éŒ„è£½å½±ç‰‡</a></h3>
<p>æ”¯æ´æ–¹ä¾¿çš„éŒ„å½±åŠŸèƒ½ï¼Œä¸éœ€è¦æ¸…ç©ºæ¡Œé¢èˆ‡èª¿æ•´è¦–çª—ä½ç½®ï¼ŒMaestro æœƒè‡ªå‹•å¹«ä½ èª¿æ•´ç‚ºåˆé©ä½ç½®ä¸¦é€²è¡ŒéŒ„è£½ï¼Œæœ€å¾Œç”¢å‡ºä¸€å€‹ä¸‹è¼‰é€£çµã€‚éå¸¸é©åˆéœ€è¦å‘å¤–éƒ¨å±•ç¤ºã€åˆ†äº«çš„æ™‚å€™ï¼Œæ˜¯å€‹è²¼å¿ƒçš„åŠŸèƒ½ã€‚</p>
<pre><code class="language-bash">maestro record test.yaml
</code></pre>
<p><img src="images/20120687sGDTtGvfV1.png" alt="" /><br />
<img src="images/XCEFrjk.gif" alt="Recording" /></p>
<p>Maestro éŒ„è£½å®Œæˆçš„å½±ç‰‡ï¼Œæ˜¯ä¸æ˜¯éå¸¸æ–¹ä¾¿ï¼Œæ­é…ç°¡æ½”å¥½çœ‹çš„èƒŒæ™¯ï¼Œä¸€ç›®äº†ç„¶ã€‚<br />
<img src="images/S853srn.gif" alt="Recording 2" /></p>
<hr />
<h2 id="maestro-in-cicd"><a class="header" href="#maestro-in-cicd">Maestro in CICD</a></h2>
<p>é¦–å…ˆæˆ‘å€‘å…ˆçœ‹ Maestro Test æ•´åˆåˆ° <strong>Gitlab CI</strong> çš„æ¨£å­ï¼ŒæœŸæœ›é™¤äº†æœ‰ Flutter Test é©—è­‰ä¹‹å¤–é‚„è¦å¤šä¸€å±¤é˜²è­·ç½©ï¼Œå°±æ˜¯è·‘ä½¿ç”¨è€…æµç¨‹çš„æ“ä½œæ¸¬è©¦ï¼Œç¢ºèªéƒ½æ²’å•é¡Œå¾Œå†é€²è¡Œå¾ŒçºŒçš„ build å’Œ deployï¼Œè€Œä¸€ä½†ç™¼ç¾æœ‰éŒ¯èª¤çš„è©±å‰‡åœæ­¢å‹•ä½œï¼Œé€šçŸ¥è² è²¬äººå“¡ã€‚<br />
<img src="images/20120687lsvVoZ2Y6n.png" alt="" /></p>
<p>å¯¦éš›å°±æ˜¯è®“ <strong>Gitlab Runner</strong> åœ¨æ©Ÿå™¨ä¸Šè·‘çš„æ™‚å€™å¯ä»¥ä¸»å‹•å•Ÿå‹•æ¨¡æ“¬å™¨ï¼Œæ¥è‘—é–‹å§‹é€²è¡Œæ¸¬è©¦é©—è­‰ï¼Œç•¶ç„¶å¦‚æœä½ çš„ CICD ç’°å¢ƒæ˜¯åœ¨é›²ç«¯çš„è©±å¯èƒ½å°±æ²’è¾¦æ³•ä½¿ç”¨ Maestro äº†ï¼Œé™¤éæ˜¯å®˜æ–¹çš„ <strong>Maestro Cloud</strong>ï¼Œå¾ˆæ–¹ä¾¿å¾ˆå¥½ç”¨ï¼Œä½†æ˜¯è·‘ä¸€å€‹ flow éœ€è¦ 0.1 ç¾å…ƒï¼Œçµæœå°±æ˜¯æœƒèŠ±å¾ˆå¤šéŒ¢ï¼Œå°æˆ‘å€‘ä¾†èªªæ‡‰è©²ä¸æ˜¯å€‹å¾ˆå¥½çš„é¸æ“‡ã€‚</p>
<h3 id="executor"><a class="header" href="#executor">Executor</a></h3>
<p>Maestro CI éœ€è¦çš„ Shell Scriptï¼Œæˆ‘é€™é‚Šè¦åŠƒæœ‰ä¸‰å€‹</p>
<ol>
<li><code>boot_simulator.sh</code> â†’ å•Ÿå‹•æ¨¡æ“¬å™¨</li>
<li><code>run_test.sh</code> â†’ åŸ·è¡Œæ¸¬è©¦é©—è­‰</li>
<li><code>shutdown_simulator.sh</code> â†’ é—œé–‰æ¨¡æ“¬å™¨</li>
</ol>
<h4 id="boot_simulatorsh"><a class="header" href="#boot_simulatorsh">boot_simulator.sh</a></h4>
<p>è£¡é¢å…¶å¯¦å¾ˆç°¡å–®ï¼Œå°±æ˜¯é€é idb å¹«æˆ‘å€‘é–‹å•Ÿæ¨¡æ“¬å™¨ï¼Œæº–å‚™å¾…æœƒè·‘æ¸¬è©¦ã€‚è£¡é¢çš„åƒæ•¸ç‚º Simulator Deivce ID</p>
<pre><code class="language-bash">#!/bin/sh

# idb_companion --boot &lt;id of the iOS device&gt;
# excute 'xcrun simctl list' in terminal to check device list.
idb_companion --boot $1
</code></pre>
<p><img src="images/TLi8k6Z.gif" alt="boot_simulator" /></p>
<h3 id="run_testsh"><a class="header" href="#run_testsh">run_test.sh</a></h3>
<ol>
<li>æŒ‡ä»¤è¦æ¸¬è©¦çš„ <code>flows/</code> ç›®éŒ„</li>
<li>é©—è­‰æ¯å€‹ Flow æµç¨‹ï¼Œå°‡å¤±æ•—å’ŒæˆåŠŸçš„æ¬¡æ•¸è¨˜éŒ„ä¸‹ä¾†</li>
<li>é¡¯ç¤ºè‡ªå®šç¾©çš„çµæœå ±å‘Šï¼ŒåŒ…å«ç¸½æ¬¡æ•¸ã€å¤±æ•—æ¬¡æ•¸ã€æˆåŠŸæ¬¡æ•¸å’Œé€šéç‡ï¼Œæ ¹æ“šé€šéç‡æª¢æŸ¥æ˜¯å¦æ­£å¸¸ï¼Œä¸€æ—¦æœ‰æ¸¬è©¦æµç¨‹å¤±æ•—çš„æƒ…æ³å‰‡æš«åœ CICD</li>
</ol>
<pre><code class="language-bash">#!/bin/sh

directory=../maestro/flows/

successedCount=0
failedCount=0

for entry in "$directory"*
do
    number=$(caculate $successedCount+$failedCount+1)
    echo "---------------------- Flow $number ------------------------"
   
    log=$(maestro test "$entry")

    if [[ $log == *"FAILED"* ]]; then
        let failedCount=failedCount+1
        continue
    fi

    let successedCount=successedCount+1

done

echo "------------------------------------------------"
echo

totalCount="$(($successedCount+$failedCount))"
echo "Total: $totalCount"
echo "Success: $successedCount"
echo "Failure: $failedCount"

percent=$(caculate $successedCount/$totalCount*100)
percent=${percent%.*}
echo "Pass: $successedCount/$totalCount, $percent%"

echo

goodEmoji='\xE2\x9C\x85'
badEmoji='\xE2\x9D\x8C'
if [ "$percent" = "100" ] 
then
    echo $goodEmoji$goodEmoji$goodEmoji
else
    echo $badEmoji
fi

echo

if [[ $percent == *"100"* ]]; then
    echo "Maestro tests passed!"
else
    echo "Maestro tests failed."
    echo
    
    exit 1 
fi

echo
</code></pre>
<p><img src="images/hlFEoKv.gif" alt="run_test" /></p>
<h3 id="shutdown_simulatorsh"><a class="header" href="#shutdown_simulatorsh">shutdown_simulator.sh</a></h3>
<p>é¡§åæ€ç¾©ï¼Œå°±æ˜¯é—œé–‰æ¨¡æ“¬å™¨ï¼Œç¯€çœæ©Ÿå™¨çš„è³‡æº</p>
<pre><code class="language-bash">idb_companion --shutdown $1
</code></pre>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<ol>
<li>é¦–å…ˆå–å¾—æ¨¡æ“¬å™¨çš„è¨­å‚™è³‡è¨Šï¼Œè¨˜å¥½è¦è·‘æ¸¬è©¦çš„ Device IDï¼ŒAndroid æˆ– iOS è¨­å‚™éƒ½å¯ä»¥</li>
</ol>
<pre><code class="language-bash">xcrun simctl list
</code></pre>
<p><img src="images/20120687YdDxx0oSZY.png" alt="" /></p>
<ol start="2">
<li>å•Ÿå‹•æ¨¡æ“¬å™¨ï¼Œåƒæ•¸ç‚ºè¦æ¸¬è©¦çš„ Device ID</li>
</ol>
<pre><code class="language-bash">./boot_simulator.sh F7CABB3C-DD6F-432D-A86F-5884287D2261
</code></pre>
<ol start="3">
<li>é‹è¡Œæ¸¬è©¦</li>
</ol>
<pre><code class="language-bash">./run_test.sh
</code></pre>
<ol start="4">
<li>é—œé–‰æ¨¡æ“¬å™¨ï¼Œåƒæ•¸ç‚ºè¦æ¸¬è©¦çš„ Device ID</li>
</ol>
<pre><code class="language-bash">./shutdown_simulator.sh F7CABB3C-DD6F-432D-A86F-5884287D2261
</code></pre>
<h2 id="demo"><a class="header" href="#demo">Demo</a></h2>
<p><img src="images/1P3oTQl.gif" alt="Demo" /><br />
<img src="images/20120687dCvThFrHXc.png" alt="" /></p>
<hr />
<h2 id="ç¸½çµ"><a class="header" href="#ç¸½çµ">ç¸½çµ</a></h2>
<p>æœ¬æ–‡çš„æœ€å¾Œæåˆ° CICDï¼Œä½¿ç”¨ Maestro æ•´åˆçš„éƒ¨åˆ†éœ€è¦åšå€‹è£œå……ã€‚åœ¨æµç¨‹é–‹å§‹æœƒå…ˆé©—è­‰æ‰€æœ‰æ¸¬è©¦ï¼Œéƒ½æ­£å¸¸æ‰æœƒé€²è¡Œå¾ŒçºŒçš„ build å’Œ deployï¼Œä¹Ÿå› ç‚º Maestro éœ€è¦æ¨¡æ“¬å™¨çš„å”åŠ©ï¼Œæ‰€ä»¥éœ€è¦ç¢ºä¿ä½ çš„ CICD å¯ä»¥å’Œè‡ªå·±æº–å‚™çš„ç’°å¢ƒæºé€šã€‚å¦‚æœåƒ Codemagic æœå‹™éƒ½åœ¨é›²ç«¯é‹è¡Œçš„è©±å¯èƒ½å°±ç„¡æ³•ä½¿ç”¨ Maestroï¼Œé‚„æ˜¯è¦æ ¹æ“šéœ€æ±‚å»æ±ºå®šä½¿ç”¨å“ªç¨®æ–¹å¼ã€‚</p>
<p>æœ€çµ‚ï¼Œæ‰€æœ‰çš„æ¸¬è©¦é‚„æ˜¯å¿…é ˆèˆ‡è‡ªå‹•åŒ–æµç¨‹çµåˆï¼Œæ‰èƒ½æœ‰æ•ˆç¯€çœæ™‚é–“æˆæœ¬ï¼Œè€Œ Maestro æœ¬èº«æœ‰é€™å€‹èƒ½åŠ›ï¼Œå®ƒè®“ä¸æ˜¯é–‹ç™¼è€…çš„å…¶ä»–äººä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“åœ°ç·¨å¯«æ¸¬è©¦ç´°ç¯€ã€‚å¦‚æœå¤§å®¶æ­£åœ¨ç…©æƒ±æ²’æ™‚é–“å¯«æ¸¬è©¦ï¼Œæˆ–æ˜¯ç¾åœ¨æ‰çŸ¥é“ E2E Testï¼ŒMaestro éƒ½å€¼å¾—ä½ å’Œåœ˜éšŠå˜—è©¦ä¸€æ¬¡ï¼Œå¾ä¸­é‹è¡Œéç©éæ‰æœƒçŸ¥é“æ˜¯å¦é©åˆç”¢å“ã€‚</p>
<p>ç¸½è€Œè¨€ä¹‹ï¼ŒMaestro æ˜¯ä¸€å€‹å¾ˆå®Œæ•´ä¸”ç©©å®šçš„ç¬¬ä¸‰æ–¹æ¸¬è©¦æœå‹™ï¼Œå®˜æ–¹ä¸åƒ…æ´»èºä¹Ÿæœ‰è‡ªå·±çš„ Slack ç©ºé–“ï¼Œæœ‰èˆˆè¶£çš„æœ‹å‹å¯ä»¥æŒçºŒé—œæ³¨æ¥ä¸‹ä¾†çš„é€²å±•èˆ‡ç‰ˆæœ¬æ›´æ–°ï¼Œæœ‰ä»»ä½•æƒ³æ³•ä¹Ÿéƒ½æ­¡è¿è·Ÿæˆ‘è¨è«–å“¦ï½</p>
<h2 id="ç›¸é—œè³‡æº"><a class="header" href="#ç›¸é—œè³‡æº">ç›¸é—œè³‡æº</a></h2>
<ul>
<li><a href="https://maestro.mobile.dev/">https://maestro.mobile.dev/</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="day25.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="day27.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="day25.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="day27.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
